
<!DOCTYPE html>
<html>
<title>Webscraping - MENA Newsletter</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?

family=Montserrat">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-

awesome/4.7.0/css/font-awesome.min.css">
<style>
body, h1,h2,h3,h4,h5,h6 {font-family: "Montserrat", sans-serif}

body, html {
  height: 100%;
  color: #000000;
}

/* Create a Parallax Effect */
.bgimg-1 {
  background-attachment: fixed;
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  background-image: url('https://je-suis-tm.github.io/img/background.jpg');
  min-height:160%;
}

.w3-panel {
  margin-top:-15%;
}
</style>
  
<head>
  <link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/je-suis-tm/je-suis-tm.github.io/master/img/favicon.ico" />
</head>
<body class="w3-black">



<!-- Navbar -->

<div >
<div class="w3-row w3-large w3-black" >  

<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/#" class="w3-block w3-button ">
HOME&emsp;<i class="fa fa-home w3-xxlarge w3-xxlarge w3-center"></i></a>
</div>      

<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/#recent" class="w3-block w3-button ">
RECENT&emsp;<i class="fa fa-newspaper-o w3-xxlarge w3-center"></i></a>
</div>
  
<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/#upcoming" class="w3-block w3-button ">
UPCOMING&emsp;<i class="fa fa-rocket w3-xxlarge w3-center"></i></a>
</div> 

<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/#about" class="w3-block w3-button ">
ABOUT&emsp;<i class="fa fa-trademark w3-xxlarge w3-center"></i></a>
</div>

<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/#contact" class="w3-block w3-button ">
CONTACT&emsp;<i class="fa fa-send w3-xxlarge w3-center"></i></a>
</div>

<div class="w3-col s2">
<a href="https://je-suis-tm.github.io/archive" class="w3-block w3-button ">
ARCHIVE&emsp;<i class="fa fa-briefcase w3-xxlarge w3-center"></i></a>
</div>

</div>
</div>
</div>


<!-- Navbar on small screens (remove the onclick attribute if you want the 

navbar to always show on top of the content when clicking on the links) -->
<div id="navDemo" class="w3-bar-block w3-black w3-hide w3-hide-large w3-hide-

medium w3-top" style="margin-top:46px">
  <a href="https://je-suis-tm.github.io" class="w3-bar-item w3-button w3-

padding-large" >HOME</a>
  <a href="https://je-suis-tm.github.io/#recent" class="w3-bar-item w3-button w3

-padding-large" >RECENT</a>
  <a href="https://je-suis-tm.github.io/#upcoming" class="w3-bar-item w3-button 

w3-padding-large" >UPCOMING</a>
  <a href="https://je-suis-tm.github.io/#about" class="w3-bar-item w3-button w3-

padding-large" >ABOUT</a>
  <a href="https://je-suis-tm.github.io#contact" class="w3-bar-item w3-button w3

-padding-large" >CONTACT</a>
</div>


<!-- Header/Home -->
  
<div class="bgimg-1 w3-display-container">
  <div class="w3-panel w3-display-middle">
    <div class="w3-opacity-min w3-center">
    <span class="w3-xxxlarge w3-text-white w3-wide ">T.M.
    </div>
    <div class="w3-opacity-min w3-center">
    <span class="w3-large w3-text-white ">Half Researcher, Half Developer.</span></div>
  </div>  
</div>


<!-- Page Content -->
  <!-- The Main Section -->
<div class="w3-container w3-black w3-centre w3-margin-top" >
<div class="w3-container w3-white w3-content w3-justify w3-margin-top" >
  
    <h2 class="w3-wide">Webscraping - MENA Newsletter</h2>
    <br>
    <p class="w3-justify">These days we receive endless bombing of newsletter both in work email and private account. Ideally, a newsletter provides you with vital and concise information to make important decisions. It’s one of the greatest end products of web scraping. Unfortunately, most of the newsletters these days merely have one objective, tapping into your inner fear of missing out. You know what? It’s time for us to show those scumbags how a great newsletter is properly done!</p><p class="w3-justify">Everyday shit happens. For someone who tracks the petroleum industry in Middle East and North Africa region, what’s the best way to keep up with the latest information? Here, we create a newsletter for the analysts who crave for market intelligence. The newsletter consists of scraping, updating, filtering and presenting. The initial stage is to scrape the news from influential sources that covers MENA region including BBC, CNN, Wall Street Journal, Financial Times, Reuters, Bloomberg and Al Jazeera. As we have gone through HTML tree, JSON searching and regular expression in the earlier chapters, this should be a walk in the park for you now. The second stage is to create a database. Since we want the latest update, not some information we have read yesterday, we need a database to keep track of the outdated information. We can simply use <span style="background-color: #f2ece1;">insert</span> command to filter all the outdated information which is the topic we have covered in the previous chapter. All the outdated information would fail the inserting process due to the no-duplicate constraint. Everything being inserted will also go into the newsletter. The third stage, filtering the useful information, is beyond the scope of web scraping. How do I apply the degree centrality to prevent information overload? You can read it from the repository of <a href=https://github.com/je-suis-tm/graph-theory/blob/master/Text%20Mining%20project/README.md>graph theory</a>. The fourth stage, presenting your newsletter, is what this chapter is centered around.</p><p class="w3-justify">There are two parts of the presenting, backend and frontend. Frontend is a lot simpler in terms of codes. A nice and comprehensive frontend is all about design. There are plenty of HTML email templates you can borrow ideas from, e.g. <a href=https://stripo.email/templates>Stripo</a>. After you obtain the information from database inserting and algorithm filtering, you can embed the information into HTML. The only tricky part is to include the image. There are a few ways to do that.</p><ul><li> Use the link of the image. This is highly recommended. Although it may be a little bit slow to load the image from the internet, it’s the most efficient way. The downside is that images are not loaded by default. The recipients need to click download image button.</li></ul><ul><li> Attach the image. Once all images are attached, we can add <span style="background-color: #f2ece1;">&lt;img src='cid: imagename.jpg'&gt;</span> into HTML email. The image will be faster to load but the email definitely takes a longer while to send and receive. Another faux pas is that the script is likely to suffer from a performance issue. We have to scrape the website repeatedly to download images.</li></ul><ul><li> Paste the raw content in the format of base64. Add <span style="background-color: #f2ece1;">>&lt;img src='data:image/jpg; base64, [remove the brackets and paste base64]'&gt;</span> into HTML email. Blocked by most email clients including Outlook is its big malaise.</li></ul><p class="w3-justify">Compared to frontend, the backend is usually a pain in the ass. Backend developers don’t take credits for flawless operation, but when things go south, they are always the cannon fodder &#x1f61f; After you put everything clean and tidy into HTML email, you don’t want to launch your email client and click the send button. C’mmon, we are programmers. We can do better! There are a few ways to achieve the goal as well. My preferable choice is <span style="background-color: #f2ece1;">win32</span>. This package allows you to control Microsoft applications through COM API. You can control outlook via Python as long as the email terminal is active in the background. The detailed commands can be referenced from <span style="background-color: #f2ece1;">mailitem</span> object model in <a href=https://msdn.microsoft.com/en-us/vba/vba-outlook>Microsoft Developer Network</a>. If you are a user of Windows 10 Pro, your outlook autoruns at startup. This seems to be the most straight forward choice. Alternatively, there is a library called <span style="background-color: #f2ece1;">smtp</span> for configuring POP3/IMAP server. I suppose the authentication of your email account would be a big hassle.</p><p class="w3-justify">With the blessing of web scraping, we eventually reduce click click click to pressing F5 in a Python IDE. Here is one final piece of the puzzle to turn your workstation into a server. The magic is called task scheduler (this is a showcase for Windows not sure Mac OS has the same thing). Task scheduler can automatically perform routine tasks at whatever criteria you set and then execute the tasks when triggered. You can run python directly in task scheduler with the script path as your argument. Here I prefer a BAT execution file which is more acceptable in a corporate network environment.</p><p class="w3-justify">Regardless of which way you pick, you need to find out where your python is installed. This can be easily done via <span style="background-color: #f2ece1;">where python</span> in the command line.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20python%20path.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">If you would love to directly call python.exe, you can skip the following procedures straight to the final step. Otherwise, you need to create a BAT execution file in notepad. Just specify the path to python.exe and the path to the script you want to automate.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20bat%20file.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">When you save the file, remember to use the extension of <span style="background-color: #f2ece1;">bat</span> instead of the default <span style="background-color: #f2ece1;">txt</span> and change the file type to <span style="background-color: #f2ece1;">All Files</span>. </p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20bat%20format.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">To launch task scheduler, you only need to search it in the start menu.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20task%20scheduler.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">Let’s start a basic task from the right-hand tab.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20create%20task.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">Just type in whatever name and description you want.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20task%20name.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">Then select the frequency, in our case, daily.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20freq.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">We can set the beginning of the execution, the time of the execution and how often the action recurs. It even allows you to synchronize the operation across different time zones. Use it especially if you are a technology consultant who frequently travels.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20set%20time.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">For some unknown reasons, task scheduler has deprecated the choice of automatically sending an email. We can still achieve the same result via <span style="background-color: #f2ece1;">win32</span> in Python, just to create a fabricated persona of a workaholic who sends midnight email to boss &#x1f612;</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20start%20program.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">Finally, we should input the path to BAT execution file. You can use the path to python as well. Then the path to the script is required as the argument.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20script%20name.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">Felicitations, c’est fini &#x1f636;</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20finito.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">You can edit or delete your task from clicking the library tab.</p><br><img src="https://raw.githubusercontent.com/je-suis-tm/web-scraping/master/preview/mena%20check.PNG" class="w3-image" width="600" height="450"><p class="w3-justify">As you can see, newsletter is not just some gibberish promotion email from Ocado. It can be used to optimize your information process as well. What kind of power a newsletter can harness is entirely up to you! </p><br><img src="https://je-suis-tm.github.io/img/newsletter.png" class="w3-image" width="600" height="450"><p class="w3-justify">For more technical details, feel free to check out <a href=https://github.com/je-suis-tm/web-scraping/blob/master/MENA%20Newsletter.py>MENA Newsletter</a>.</p>
    <br>
    <br>
    <p>Click the icon below to be redirected to GitHub Repository</p>
    <a href="https://github.com/je-suis-tm/web-scraping/blob/master/MENA%20Newsletter.py" target="_blank"><i class="fa fa-github-alt fa-fw w3-

xxlarge"></i></a>
  
  <!-- End Main Section -->   
</div>	  
</div>
</body>
<hr>  
  
  <!-- Footer -->
  <footer class="w3-container w3-card w3-black w3-margin-bottom">
    <a href="https://github.com/je-suis-tm" target="_blank"><i class="fa fa-

github-square w3-hover-opacity"></i></a>
    <i class="fa fa-linkedin-square w3-hover-opacity"></i>
    <i class="fa fa-facebook-square w3-hover-opacity"></i>
    <i class="fa fa-twitter-square w3-hover-opacity"></i>
    <i class="fa fa-whatsapp w3-hover-opacity"></i>
    <i class="fa fa-snapchat-square w3-hover-opacity"></i>
    <p class="w3-small">I can change the footer, but this template is really 

fabulous, it is powered by <a href="https://www.w3schools.com/w3css/default.asp" 

target="_blank" class="w3-hover-text-green">w3.css</a></p>
  <!-- End footer -->
  </footer>


<!-- END PAGE CONTENT -->

</html>

